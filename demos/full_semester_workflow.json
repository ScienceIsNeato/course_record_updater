{
  "demo_name": "Full Semester Lifecycle Story",
  "demo_id": "full_semester_story",
  "version": "2.0",
  "description": "A story-driven walkthrough of a full semester lifecycle, featuring date travel, cross-departmental course duplication, faculty onboarding, and end-of-term audit workflows.",
  "estimated_duration_minutes": 25,
  "talking_points": [
    "System Date Override allows testing full semester cycles in minutes",
    "Cross-departmental course duplication streamlines curriculum expansion",
    "Closed-loop audit workflow ensures data quality before warehousing",
    "Role-based dashboards focus users on immediate tasks"
  ],
  "environment": {
    "working_directory": ".",
    "setup_commands": [
      "source venv/bin/activate && source .envrc",
      "python scripts/seed_db.py --demo --manifest demos/full_semester_manifest.json --clear --env dev",
      "./scripts/restart_server.sh dev"
    ],
    "base_url": "http://localhost:3001",
    "cleanup_commands": []
  },
  "steps": [
    {
      "step_number": 1,
      "phase": "Act 1: Planning (Oct 2025)",
      "name": "Verify Environment & Date",
      "purpose": "Confirm date override is active for the Fall 2025 planning phase",
      "pre_commands": [],
      "instructions": {
        "human": "The server has been seeded with the Institution Admin date set to Oct 15, 2025.\n\nLogin as 'demo2025.admin@example.com' (Password: Demo2025!).\nNotice the yellow 'System Date Override' banner.",
        "automated": {
          "action": "api_post",
          "endpoint": "/api/auth/login",
          "data": {
            "email": "demo2025.admin@example.com",
            "password": "Demo2025!"
          },
          "description": "Login as Sarah Admin"
        }
      },
      "urls": [
        {
          "label": "Login Page",
          "url": "http://localhost:3001/login",
          "clickable": true
        }
      ],
      "inputs": {
        "email": "demo2025.admin@example.com",
        "password": "Demo2025!"
      },
      "expected_results": [
        "Dashboard loads",
        "Banner shows: 'System Date Override Active: Oct 15, 2025'"
      ],
      "post_commands": [],
      "verification": {
        "type": "ui_check",
        "expected_url": "/dashboard"
      },
      "artifacts": {
        "screenshots": [
          "01_act1_dashboard_banner.png"
        ]
      },
      "pause_for_human": true
    },
    {
      "step_number": 2,
      "phase": "Act 1: Planning (Oct 2025)",
      "name": "Create Spring 2026 Term",
      "purpose": "Prepare for the upcoming semester",
      "pre_commands": [],
      "instructions": {
        "human": "Navigate to 'Terms'.\nCreate a new term:\n- Name: Spring 2026\n- Code: SP2026\n- Start: Jan 15, 2026\n- End: May 15, 2026\n- Assessment Due: May 20, 2026",
        "automated": {
          "action": "api_post",
          "endpoint": "/api/terms",
          "data": {
            "name": "Spring 2026",
            "code": "SP2026",
            "start_date": "2026-01-15",
            "end_date": "2026-05-15",
            "assessment_due_date": "2026-05-20"
          },
          "description": "Create SP2026 term"
        }
      },
      "urls": [],
      "inputs": {
        "name": "Spring 2026",
        "code": "SP2026"
      },
      "expected_results": [
        "Spring 2026 term appears in list"
      ],
      "post_commands": [
        {
          "command": "sqlite3 course_records_dev.db \"SELECT id FROM terms WHERE name='Spring 2026' LIMIT 1\"",
          "purpose": "Capture SP2026 ID",
          "capture_output_as": "sp26_term_id"
        }
      ],
      "verification": {
        "type": "db_check"
      },
      "artifacts": {},
      "pause_for_human": true
    },
    {
      "step_number": 3,
      "phase": "Act 1: Planning (Oct 2025)",
      "name": "Duplicate Biology for Zoology",
      "purpose": "Create BIOL-101-Z tailored for Zoology program",
      "pre_commands": [
        {
          "command": "sqlite3 course_records_dev.db \"SELECT id FROM courses WHERE course_number='BIOL-101' LIMIT 1\"",
          "purpose": "Get BIOL-101 ID",
          "capture_output_as": "biol101_id"
        },
        {
          "command": "sqlite3 course_records_dev.db \"SELECT id FROM programs WHERE short_name='ZOOL' LIMIT 1\"",
          "purpose": "Get Zoology Program ID",
          "capture_output_as": "zool_program_id"
        }
      ],
      "instructions": {
        "human": "Navigate to Courses.\nFind 'BIOL-101' and click Duplicate.\nUpdate details:\n- Number: BIOL-101-Z\n- Title: Biology for Zoologists\n- Credits: 2\n- Program: Zoology",
        "automated": {
          "action": "api_post",
          "endpoint": "/api/management/courses/{{biol101_id}}/duplicate",
          "data": {
            "new_course_number": "BIOL-101-Z",
            "new_course_title": "Biology for Zoologists",
            "credit_hours": 2,
            "program_ids": [
              "{{zool_program_id}}"
            ]
          },
          "description": "Duplicate BIOL-101 to BIOL-101-Z"
        }
      },
      "urls": [],
      "inputs": {
        "course": "BIOL-101-Z"
      },
      "expected_results": [
        "BIOL-101-Z course created"
      ],
      "post_commands": [
        {
          "command": "sqlite3 course_records_dev.db \"SELECT id FROM courses WHERE course_number='BIOL-101-Z' LIMIT 1\"",
          "purpose": "Capture BIOL-101-Z ID",
          "capture_output_as": "biol101z_id"
        }
      ],
      "verification": {
        "type": "db_check"
      },
      "artifacts": {},
      "pause_for_human": true
    },
    {
      "step_number": 4,
      "phase": "Act 1: Planning (Oct 2025)",
      "name": "Create Offering & Assign Faculty",
      "purpose": "Schedule the course and assign instructors",
      "pre_commands": [
        {
          "command": "sqlite3 course_records_dev.db \"SELECT id FROM users WHERE email='dr.morgan@demo.example.com' LIMIT 1\"",
          "purpose": "Get Dr. Morgan ID",
          "capture_output_as": "morgan_id"
        }
      ],
      "instructions": {
        "human": "Create Offering for BIOL-101-Z in SP2026.\nAdd 2 Sections:\n- 001: Assign Dr. Morgan (Existing)\n- 002: Click 'Invite' and send to 'dr.newguy@example.com'",
        "automated": {
          "action": "api_post",
          "endpoint": "/api/offerings",
          "data": {
            "course_id": "{{biol101z_id}}",
            "term_id": "{{sp26_term_id}}",
            "sections": [
              {
                "section_number": "001",
                "instructor_id": "{{morgan_id}}",
                "capacity": 30
              },
              {
                "section_number": "002",
                "capacity": 30
              }
            ]
          },
          "description": "Create offering with sections"
        }
      },
      "urls": [],
      "inputs": {
        "offering": "BIOL-101-Z SP26"
      },
      "expected_results": [
        "Offering created"
      ],
      "post_commands": [
        {
          "command": "sqlite3 course_records_dev.db \"SELECT id FROM course_sections WHERE section_number='002' AND offering_id=(SELECT id FROM course_offerings WHERE course_id='{{biol101z_id}}' AND term_id='{{sp26_term_id}}')\"",
          "purpose": "Capture Section 002 ID",
          "capture_output_as": "section_002_id"
        }
      ],
      "verification": {
        "type": "db_check"
      },
      "artifacts": {},
      "pause_for_human": true
    },
    {
      "step_number": 5,
      "phase": "Act 1: Planning (Oct 2025)",
      "name": "Invite Dr. Newguy",
      "purpose": "Onboard new faculty member",
      "pre_commands": [],
      "instructions": {
        "human": "In the Sections list for BIOL-101-Z:\nClick Invitation icon for Section 002.\nEmail: dr.newguy@example.com\nSend Invitation.",
        "automated": {
          "action": "api_post",
          "endpoint": "/api/invitations",
          "data": {
            "email": "dr.newguy@example.com",
            "section_id": "{{section_002_id}}",
            "role": "instructor"
          },
          "description": "Invite Dr. Newguy"
        }
      },
      "urls": [],
      "inputs": {
        "email": "dr.newguy@example.com"
      },
      "expected_results": [
        "Invitation sent"
      ],
      "post_commands": [],
      "verification": {
        "type": "log_check"
      },
      "artifacts": {
        "logs": [
          "email.log"
        ]
      },
      "pause_for_human": true
    },
    {
      "step_number": 6,
      "phase": "Act 2: Onboarding (Oct 2025)",
      "name": "Dr. Newguy Registration",
      "purpose": "Simulate new faculty accepting invitation",
      "pre_commands": [
        {
          "command": "sqlite3 course_records_dev.db \"SELECT token FROM user_invitations WHERE email='dr.newguy@example.com' ORDER BY created_at DESC LIMIT 1\"",
          "purpose": "Get invitation token",
          "capture_output_as": "invite_token"
        }
      ],
      "instructions": {
        "human": "Logout as Admin.\n(Optional) Check email logs for invite link.\nSimulate clicking link: Register Dr. Newguy.\nLogin as Dr. Newguy and see assigned course.",
        "automated": {
          "action": "api_post",
          "endpoint": "/api/auth/accept-invitation",
          "data": {
            "invitation_token": "{{invite_token}}",
            "password": "Password123!",
            "display_name": "New Guy"
          },
          "description": "Register Dr. Newguy"
        }
      },
      "urls": [
        {
          "label": "Logout",
          "url": "http://localhost:3001/logout",
          "clickable": true
        }
      ],
      "inputs": {},
      "expected_results": [
        "Registration successful",
        "Dr. Newguy logged in"
      ],
      "post_commands": [],
      "verification": {
        "type": "db_check"
      },
      "artifacts": {},
      "pause_for_human": true
    },
    {
      "step_number": 7,
      "phase": "Act 3: Semester End (Dec 2025)",
      "name": "Time Jump: Dec 20, 2025",
      "purpose": "Advance timeline to end of Fall semester (3 days post-deadline)",
      "pre_commands": [],
      "instructions": {
        "human": "Logout Dr. Newguy.\nLogin as Sarah Admin.\n\nUse the Date Override feature to jump to: December 20, 2025.\nThis puts us past the FA2025 deadline.",
        "automated": {
          "action": "sequence",
          "steps": [
            {
              "action": "api_post",
              "endpoint": "/api/auth/logout",
              "data": {}
            },
            {
              "action": "api_post",
              "endpoint": "/api/auth/login",
              "data": {
                "email": "demo2025.admin@example.com",
                "password": "Demo2025!"
              }
            },
            {
              "action": "api_post",
              "endpoint": "/api/profile/system-date",
              "data": {
                "system_date": "2025-12-20T09:00:00"
              }
            }
          ]
        }
      },
      "urls": [],
      "inputs": {
        "date": "2025-12-20"
      },
      "expected_results": [
        "Date Banner: Dec 20, 2025",
        "Dashboard context updated"
      ],
      "post_commands": [],
      "verification": {
        "type": "ui_check"
      },
      "artifacts": {
        "screenshots": [
          "02_act3_date_jump.png"
        ]
      },
      "pause_for_human": true
    },
    {
      "step_number": 8,
      "phase": "Act 3: Semester End (Dec 2025)",
      "name": "Audit Queue Review",
      "purpose": "Review submissions and identify issues",
      "pre_commands": [],
      "instructions": {
        "human": "Navigate to 'Audit CLO'.\nObserve:\n- Dr. Morgan's BIOL-101 submission (Needs Rework - seeded error)\n- Dr. Newguy's SP26 course (Assigned, future)\n- ZOOL-101 (NCI - seeded)\n\nFilter by 'Submitted'.",
        "automated": {
          "action": "none",
          "url": "/audit-clo"
        }
      },
      "urls": [],
      "inputs": {},
      "expected_results": [
        "Audit table loaded"
      ],
      "post_commands": [],
      "verification": {
        "type": "ui_check"
      },
      "artifacts": {},
      "pause_for_human": true
    },
    {
      "step_number": 9,
      "phase": "Act 3: Semester End (Dec 2025)",
      "name": "Request Rework on BIOL-101",
      "purpose": "Demonstrate feedback loop for incorrect submissions",
      "pre_commands": [
        {
          "command": "sqlite3 course_records_dev.db \"SELECT id FROM course_outcomes WHERE clo_number='4' AND description LIKE '%basket%' LIMIT 1\"",
          "purpose": "Find the seeded 'Bad' CLO",
          "capture_output_as": "bad_clo_id"
        }
      ],
      "instructions": {
        "human": "Find the BIOL-101 CLO #4 with 'Basket Weaving' description.\nClick 'Request Rework'.\nComment: 'Description mismatch. Please correct copy/paste error.'",
        "automated": {
          "action": "api_post",
          "endpoint": "/api/outcomes/{{bad_clo_id}}/request-rework",
          "data": {
            "comments": "Description mismatch. Please correct copy/paste error."
          },
          "description": "Flag CLO for rework"
        }
      },
      "urls": [],
      "inputs": {
        "comment": "Description mismatch"
      },
      "expected_results": [
        "Status changes to Needs Rework"
      ],
      "post_commands": [],
      "verification": {
        "type": "db_check"
      },
      "artifacts": {},
      "pause_for_human": true
    },
    {
      "step_number": 10,
      "phase": "Act 4: Correction (Dec 2025)",
      "name": "Faculty Fixes Rework",
      "purpose": "Show faculty addressing admin feedback",
      "pre_commands": [],
      "instructions": {
        "human": "Logout Admin.\nLogin as Dr. Morgan (Instructor123!).\nSee 'Needs Rework' badge.\nEdit CLO #4: Change 'Basket Weaving' to 'Scientific Method'.\nResubmit.",
        "automated": {
          "action": "sequence",
          "steps": [
            {
              "action": "api_post",
              "endpoint": "/api/auth/logout",
              "data": {}
            },
            {
              "action": "api_post",
              "endpoint": "/api/auth/login",
              "data": {
                "email": "dr.morgan@demo.example.com",
                "password": "Instructor123!"
              }
            },
            {
              "action": "api_put",
              "endpoint": "/api/outcomes/{{bad_clo_id}}",
              "data": {
                "description": "Demonstrate proficiency in Scientific Method",
                "status": "submitted"
              }
            }
          ]
        }
      },
      "urls": [],
      "inputs": {
        "description": "Scientific Method"
      },
      "expected_results": [
        "CLO status updated to Submitted"
      ],
      "post_commands": [],
      "verification": {
        "type": "db_check"
      },
      "artifacts": {},
      "pause_for_human": true
    },
    {
      "step_number": 11,
      "phase": "Act 5: Closeout (Jan 2026)",
      "name": "Time Jump: Jan 25, 2026",
      "purpose": "Finalize previous semester data",
      "pre_commands": [],
      "instructions": {
        "human": "Logout Dr. Morgan.\nLogin as Sarah Admin.\n\nUpdate Date Override: Jan 25, 2026.\nNow we are in SP2026 term context.",
        "automated": {
          "action": "sequence",
          "steps": [
            {
              "action": "api_post",
              "endpoint": "/api/auth/logout",
              "data": {}
            },
            {
              "action": "api_post",
              "endpoint": "/api/auth/login",
              "data": {
                "email": "demo2025.admin@example.com",
                "password": "Demo2025!"
              }
            },
            {
              "action": "api_post",
              "endpoint": "/api/profile/system-date",
              "data": {
                "system_date": "2026-01-25T09:00:00"
              }
            }
          ]
        }
      },
      "urls": [],
      "inputs": {
        "date": "2026-01-25"
      },
      "expected_results": [
        "Date Banner: Jan 25, 2026"
      ],
      "post_commands": [],
      "verification": {
        "type": "ui_check"
      },
      "artifacts": {
        "screenshots": [
          "03_act5_date_jump.png"
        ]
      },
      "pause_for_human": true
    },
    {
      "step_number": 12,
      "phase": "Act 5: Closeout (Jan 2026)",
      "name": "Approve Fix & Mark NCI",
      "purpose": "Close out all FA2025 items",
      "pre_commands": [
        {
          "command": "sqlite3 course_records_dev.db \"SELECT id FROM course_outcomes WHERE clo_number='5' AND description LIKE '%unicorns%' LIMIT 1\"",
          "purpose": "Find the seeded 'NCI' CLO (Unicorns)",
          "capture_output_as": "nci_clo_id"
        }
      ],
      "instructions": {
        "human": "Navigate to Audit.\n1. Approve Dr. Morgan's fixed CLO #4.\n2. Locate ZOOL-101 CLO #5 (Unicorns).\n3. Click 'Mark NCI' (Never Coming In) - Faculty unreachable.\n\nDashboard should now be clean for FA2025.",
        "automated": {
          "action": "sequence",
          "steps": [
            {
              "action": "api_post",
              "endpoint": "/api/management/audit/{{bad_clo_id}}/approve",
              "data": {},
              "description": "Approve fixed CLO #4"
            },
            {
              "action": "api_post",
              "endpoint": "/api/management/audit/{{nci_clo_id}}/nci",
              "data": {
                "admin_comment": "Faculty unreachable after 3 attempts."
              },
              "description": "Mark CLO #5 as NCI"
            }
          ]
        }
      },
      "urls": [],
      "inputs": {},
      "expected_results": [
        "CLO #4 Approved",
        "CLO #5 NCI",
        "Audit queue clear"
      ],
      "post_commands": [],
      "verification": {
        "type": "ui_check"
      },
      "artifacts": {
        "screenshots": [
          "04_final_dashboard.png"
        ]
      },
      "pause_for_human": true
    },
    {
      "step_number": 13,
      "phase": "Completion",
      "name": "Demo Complete",
      "purpose": "Wrap up",
      "pre_commands": [],
      "instructions": {
        "human": "Demo successfully completed. \nShown: Date travel, Duplication, Invitations, Registration, Rework Loops, and Audit Closeout.",
        "automated": {
          "action": "none"
        }
      },
      "urls": [],
      "inputs": {},
      "expected_results": [],
      "post_commands": [],
      "verification": {
        "type": "none"
      },
      "artifacts": {},
      "pause_for_human": false
    }
  ]
}