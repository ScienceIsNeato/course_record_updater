# SonarQube Configuration for Course Record Updater
# This configuration enables comprehensive code quality analysis

# Project Information
sonar.projectKey=ScienceIsNeato_course_record_updater
sonar.organization=scienceisneato

# Source Code Configuration - Only analyze core application code
sonar.sources=.
sonar.language=py
sonar.sourceEncoding=UTF-8

# Exclusions - Files and directories to exclude from analysis
sonar.exclusions=\
    venv/**,\
    **/.venv/**,\
    **/node_modules/**,\
    **/__pycache__/**,\
    **/*.pyc,\
    cursor-rules/**,\
    build-output/**,\
    logs/**,\
    python-database/**,\
    flask_session/**,\
    static/images/**,\
    scripts/**,\
    tests/**,\
    research/**,\
    planning/**,\
    import_cli.py,\
    generate_sample_docx.py,\
    **/*.xlsx,\
    **/*.docx,\
    **/*.pdf,\
    **/*.mov,\
    **/*.csv,\
    **/*.sarif,\
    **/*.json,\
    **/*.json,\
    **/build-wrapper-dump.json,\
    demos/**,\
    docs/workflow-walkthroughs/scripts/**

# Test Configuration
sonar.tests=tests
sonar.test.inclusions=tests/**/*.py
sonar.test.exclusions=tests/conftest.py

# Python-specific configuration
# Coverage reporting - enable coverage data for SonarCloud
sonar.python.coverage.reportPaths=coverage.xml
sonar.python.xunit.reportPath=test-results.xml

# JavaScript-specific configuration
# Coverage reporting - enable JavaScript coverage data for SonarCloud
sonar.javascript.lcov.reportPaths=coverage/lcov.info

# New Code Definition - use previous version for new code detection
sonar.newCode.referenceBranch=previousVersion

# Branch Configuration - will be overridden by workflow args
# sonar.branch.name=main

# Code Quality Rules
# Enable detection of code smells, bugs, and security vulnerabilities
# Note: Using SonarCloud's built-in Python analyzer instead of external pylint
# sonar.python.pylint.reportPaths=build-output/pylint-report.txt

# Quality Gate Configuration
# Set thresholds for various metrics
# Enabled for CI/CD pipeline - will fail CI if quality gate fails
sonar.qualitygate.wait=true
sonar.qualitygate.timeout=600

# Duplication Configuration
# Detect code duplication more aggressively (match IDE plugin sensitivity)
sonar.cpd.python.minimumtokens=20
sonar.cpd.python.minimumlines=3

# Coverage Configuration
# Set coverage thresholds to match our 80% requirement
# Exclude test files, script files, and demo tooling from coverage requirements
sonar.coverage.exclusions=\
    tests/**,\
    **/*_test.py,\
    **/test_*.py,\
    scripts/**,\
    demos/**,\
    docs/workflow-walkthroughs/scripts/**

# Security Configuration
# Enable security vulnerability detection including log injection
# Note: Using SonarCloud's built-in security analyzer instead of external bandit
# sonar.python.bandit.reportPaths=build-output/bandit-report.json
sonar.security.hotspots.inherit=NONE
sonar.security.review.rating=A

# Maintainability Configuration
# Enable detection of code smells and maintainability issues
# Note: Using SonarCloud's built-in analyzer instead of external flake8
# sonar.python.flake8.reportPaths=build-output/flake8-report.txt

# Additional Analysis Parameters
# Enable more comprehensive analysis
sonar.python.version=3.11
sonar.python.file.suffixes=.py

# Security and Quality Rules Configuration
# Enable comprehensive rule detection to match IDE plugin
sonar.python.S5145.activate=true
sonar.python.S1192.activate=true
sonar.python.S6903.activate=true
sonar.python.S1135.activate=true
sonar.python.S1244.activate=true

# Quality Profile Configuration
# Use the most comprehensive quality profile available
sonar.profile.python=Sonar way

# Issue Detection Configuration - Be more restrictive to match IDE
sonar.issue.ignore.multicriteria=e1

# Only ignore TODO comments in planning documents
sonar.issue.ignore.multicriteria.e1.ruleKey=python:S1135
sonar.issue.ignore.multicriteria.e1.resourceKey=planning/**

# Analysis Configuration
# Using SonarCloud's built-in analyzers (more reliable than external tools)
# sonar.python.pylint=true
# sonar.python.bandit=true  
# sonar.python.flake8=true

# Performance Configuration
# Optimize analysis performance
sonar.scm.disabled=false
sonar.scm.provider=git

# Reporting Configuration
# Generate detailed reports
sonar.verbose=false
sonar.log.level=INFO

